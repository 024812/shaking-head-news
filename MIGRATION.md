# 迁移指南 (Migration Guide)

本文档提供从旧版本浏览器扩展迁移到新版 Web 应用的完整指南。

---

## 📋 目录

- [概述](#概述)
- [主要变化](#主要变化)
- [迁移前准备](#迁移前准备)
- [数据迁移](#数据迁移)
- [功能对照表](#功能对照表)
- [常见问题](#常见问题)
- [回滚方案](#回滚方案)

---

## 概述

### 从浏览器扩展到 Web 应用

新版本是一个完整的 Web 应用，不再需要安装浏览器扩展。主要优势：

- ✅ **跨浏览器**: 任何现代浏览器都可以访问
- ✅ **跨设备**: 手机、平板、电脑都能使用
- ✅ **云同步**: 设置自动同步到云端
- ✅ **更好的性能**: 使用 Next.js ISR 缓存
- ✅ **更多功能**: RSS 管理、统计数据、健康提醒等

### 技术栈变化

| 组件     | 旧版本       | 新版本                     |
| -------- | ------------ | -------------------------- |
| 框架     | Vue 3        | Next.js 15 + React 19      |
| 类型     | 浏览器扩展   | Web 应用                   |
| 存储     | LocalStorage | Upstash Redis (云端)       |
| 认证     | 无           | NextAuth.js (Google OAuth) |
| 样式     | CSS          | Tailwind CSS 4             |
| 状态管理 | Pinia        | Zustand                    |
| 构建工具 | Vite         | Turbopack                  |

---

## 主要变化

### 1. 访问方式

**旧版本**:

- 需要安装浏览器扩展
- 点击扩展图标打开

**新版本**:

- 直接访问 [https://024812.xyz](https://024812.xyz)
- 可以添加到主屏幕 (PWA 即将支持)

### 2. 用户认证

**旧版本**:

- 无需登录
- 设置存储在本地

**新版本**:

- 可选的 Google OAuth 登录
- 登录后设置自动云同步
- 未登录用户仍可使用，设置存储在本地

### 3. 数据存储

**旧版本**:

- 使用浏览器 LocalStorage
- 数据仅存储在本地
- 无法跨设备同步

**新版本**:

- 登录用户: Upstash Redis (云端)
- 未登录用户: LocalStorage (本地)
- 支持跨设备同步

### 4. 新增功能

新版本新增以下功能：

- 🔐 **用户认证**: Google OAuth 登录
- ☁️ **云同步**: 设置自动同步到云端
- 📊 **统计数据**: 运动记录和数据可视化
- 🔔 **健康提醒**: 浏览器通知提醒
- 📰 **RSS 管理**: 添加、管理自定义 RSS 源
- 📤 **OPML 导出**: 导出 RSS 订阅配置
- 🌍 **多语言**: 完整的中英文支持
- 🎨 **主题切换**: 浅色/深色模式
- 📱 **响应式**: 完美适配移动设备

---

## 迁移前准备

### 1. 导出旧版本设置

如果你使用的是旧版本浏览器扩展，请先导出你的设置：

1. 打开浏览器扩展
2. 进入设置页面
3. 点击"导出设置"按钮
4. 保存 JSON 文件到本地

### 2. 记录重要信息

记录以下信息，以便在新版本中重新配置：

- [ ] 旋转模式 (固定/连续)
- [ ] 旋转间隔时间
- [ ] 字体大小偏好
- [ ] 主题偏好 (浅色/深色)
- [ ] 自定义 RSS 源列表

### 3. 卸载旧版本 (可选)

迁移完成后，你可以卸载浏览器扩展：

**Chrome/Edge**:

1. 打开 `chrome://extensions/`
2. 找到"摇头看新闻"扩展
3. 点击"移除"

**Firefox**:

1. 打开 `about:addons`
2. 找到"摇头看新闻"扩展
3. 点击"移除"

---

## 数据迁移

### 手动迁移

由于新旧版本架构差异较大，需要手动配置设置：

#### 1. 基本设置

在设置页面手动配置：

- **语言**: 中文/英文
- **主题**: 浅色/深色/跟随系统
- **字体大小**: 小/中/大/特大
- **布局模式**: 正常/紧凑

#### 2. 旋转设置

- **旋转模式**: 固定/连续
- **旋转间隔**: 5-300 秒
- **启用动画**: 开/关

#### 3. RSS 源

手动添加你的 RSS 源：

1. 进入 RSS 管理页面
2. 点击"添加 RSS 源"
3. 填写 RSS 源信息：
   - 名称
   - URL
   - 语言
   - 标签 (可选)
4. 点击"保存"

#### 4. 统计数据

旧版本的统计数据无法迁移，新版本会从零开始记录。

---

## 功能对照表

### 核心功能

| 功能         | 旧版本 | 新版本 | 说明                |
| ------------ | ------ | ------ | ------------------- |
| 新闻浏览     | ✅     | ✅     | 功能相同            |
| 页面旋转     | ✅     | ✅     | 新增更多控制选项    |
| 固定模式     | ✅     | ✅     | 功能相同            |
| 连续模式     | ✅     | ✅     | 功能相同            |
| 旋转间隔调整 | ✅     | ✅     | 范围扩展到 5-300 秒 |
| 暂停/继续    | ✅     | ✅     | 功能相同            |
| 主题切换     | ✅     | ✅     | 新增"跟随系统"选项  |
| 字体大小     | ✅     | ✅     | 新增"特大"选项      |

### 新增功能

| 功能       | 说明                     |
| ---------- | ------------------------ |
| 用户认证   | Google OAuth 登录        |
| 云同步     | 设置自动同步到云端       |
| 统计数据   | 运动记录和数据可视化     |
| 健康提醒   | 浏览器通知提醒           |
| RSS 管理   | 添加、管理自定义 RSS 源  |
| OPML 导出  | 导出 RSS 订阅配置        |
| 多语言     | 完整的中英文支持         |
| 响应式设计 | 完美适配移动设备         |
| 性能优化   | ISR 缓存，更快的加载速度 |

### 移除的功能

| 功能           | 原因            | 替代方案         |
| -------------- | --------------- | ---------------- |
| 浏览器扩展 API | 迁移到 Web 应用 | 使用 Web API     |
| 本地存储 (仅)  | 新增云同步      | 可选择本地或云端 |

---

## 常见问题

### Q1: 我必须登录才能使用吗？

**A**: 不需要。新版本支持两种使用方式：

- **未登录**: 设置存储在本地，功能完整可用
- **已登录**: 设置自动同步到云端，可跨设备使用

### Q2: 我的旧版本设置会丢失吗？

**A**: 不会。你可以：

1. 使用迁移工具导入旧版本设置
2. 手动重新配置设置
3. 旧版本扩展仍可继续使用

### Q3: 新版本支持哪些浏览器？

**A**: 支持所有现代浏览器：

- ✅ Chrome 90+
- ✅ Edge 90+
- ✅ Firefox 88+
- ✅ Safari 14+
- ✅ Opera 76+

### Q4: 新版本的性能如何？

**A**: 新版本性能更好：

- **首屏加载**: < 2.5s (使用 ISR 缓存)
- **新闻刷新**: < 1s (使用缓存)
- **页面切换**: < 0.5s (预加载)

### Q5: 我可以同时使用旧版本和新版本吗？

**A**: 可以。两个版本互不影响，你可以：

- 在桌面使用旧版本扩展
- 在移动设备使用新版本 Web 应用
- 逐步迁移到新版本

### Q6: 新版本的数据安全吗？

**A**: 非常安全：

- ✅ 使用 HTTPS 加密传输
- ✅ 数据存储在 Upstash Redis (加密)
- ✅ 实施了完整的安全措施 (CSP, 速率限制等)
- ✅ 不收集个人信息
- ✅ 可随时删除数据

### Q7: 如何删除我的数据？

**A**: 在设置页面：

1. 滚动到"数据管理"部分
2. 点击"删除所有数据"
3. 确认删除

或者直接登出账号，数据会在 90 天后自动删除。

### Q8: 新版本支持离线使用吗？

**A**: 部分支持：

- ✅ 已缓存的新闻可以离线查看
- ✅ 设置可以离线修改 (登录用户需在线同步)
- ⏳ 完整的 PWA 离线支持即将推出

### Q9: 我可以导出新版本的数据吗？

**A**: 可以。在设置页面：

1. 滚动到"数据管理"部分
2. 点击"导出数据"
3. 选择导出格式 (JSON/OPML)
4. 下载文件

### Q10: 新版本有移动端 App 吗？

**A**: 目前是响应式 Web 应用，可以：

- 在移动浏览器中访问
- 添加到主屏幕 (类似 App)
- ⏳ 原生移动端 App 在路线图中

---

## 回滚方案

如果你在使用新版本时遇到问题，可以回滚到旧版本：

### 1. 导出新版本设置

在新版本设置页面：

1. 滚动到"数据管理"部分
2. 点击"导出数据"
3. 保存 JSON 文件

### 2. 重新安装旧版本扩展

**Chrome/Edge**:

1. 下载旧版本扩展文件
2. 打开 `chrome://extensions/`
3. 启用"开发者模式"
4. 点击"加载已解压的扩展程序"
5. 选择扩展文件夹

**Firefox**:

1. 下载旧版本扩展文件
2. 打开 `about:debugging#/runtime/this-firefox`
3. 点击"临时载入附加组件"
4. 选择扩展文件

### 3. 导入设置

在旧版本扩展中：

1. 打开设置页面
2. 点击"导入设置"
3. 选择之前导出的 JSON 文件

### 4. 报告问题

如果你需要回滚，请帮助我们改进：

1. 在 GitHub 创建 Issue
2. 描述遇到的问题
3. 提供错误信息和截图
4. 我们会尽快修复

---

## 迁移检查清单

使用此检查清单确保迁移成功：

### 迁移前

- [ ] 导出旧版本设置
- [ ] 记录重要配置信息
- [ ] 备份自定义 RSS 源列表
- [ ] 截图旧版本界面 (作为参考)

### 迁移中

- [ ] 访问新版本应用
- [ ] 创建账号或使用 Google 登录 (可选)
- [ ] 使用迁移工具导入设置
- [ ] 验证所有设置是否正确
- [ ] 测试旋转功能
- [ ] 测试新闻刷新
- [ ] 添加自定义 RSS 源

### 迁移后

- [ ] 确认所有功能正常工作
- [ ] 测试跨设备同步 (如果已登录)
- [ ] 探索新功能 (统计、健康提醒等)
- [ ] 添加到浏览器书签或主屏幕
- [ ] 卸载旧版本扩展 (可选)
- [ ] 向朋友推荐新版本 😊

---

## 获取帮助

如果在迁移过程中遇到问题：

### 文档资源

- [README.md](README.md) - 项目概述和快速开始
- [docs/SETUP.md](docs/SETUP.md) - 详细设置指南
- [docs/PERFORMANCE_GUIDE.md](docs/PERFORMANCE_GUIDE.md) - 性能优化指南

### 社区支持

- **GitHub Issues**: [https://github.com/024812/shaking-head-news/issues](https://github.com/024812/shaking-head-news/issues)
- **GitHub Discussions**: [https://github.com/024812/shaking-head-news/discussions](https://github.com/024812/shaking-head-news/discussions)

### 联系方式

- **Email**: 024812@users.noreply.github.com
- **GitHub**: [@024812](https://github.com/024812)

---

## 反馈和建议

我们非常重视你的反馈！

### 如何提供反馈

1. **GitHub Issues**: 报告 bug 或请求新功能
2. **GitHub Discussions**: 分享使用体验和建议
3. **Pull Request**: 直接贡献代码

### 我们想知道

- ✅ 迁移过程是否顺利？
- ✅ 有哪些功能你特别喜欢？
- ✅ 有哪些功能你希望改进？
- ✅ 有哪些新功能你希望添加？

---

**感谢你选择摇头看新闻！祝你使用愉快！** 📰🤸‍♂️

<p align="center">Made with ❤️ by 024812</p>
